var request = require('request')
const cve_list =require('../models/cve_list.model');



exports.deviceType = function(req, res, next) {
    var device_type=req.body.device_type;
    var cve_id=req.body.cve_id;
    cve_list.updateOne({"cveid":cve_id}, {$set:{"device_type":device_type}},function(err, response){
        if(err){
            res.status(500).json({ success: false ,error:JSON.stringify(err)}).end('');
        }
        else{
            res.status(200).json({ success: true,device_type:device_type}).end('');
        }
    }
    );
}




exports.currentOsVersion = function(req, res, next) {
    var current_os_version=req.body.current_os_version;
    var cve_id=req.body.cve_id;
    cve_list.updateOne({"cveid":cve_id}, {$set:{"current_os_version":current_os_version}},function(err, response){
        if(err){
            res.status(500).json({ success: false,error:JSON.stringify(err) }).end('');
        }
        else{
            res.status(200).json({ success: true,current_os_version:current_os_version}).end('');
        }
    }
    );
}

exports.impactedModule = function(req, res, next) {
    var module_or_feature_impacted=req.body.module_or_feature_impacted;
    var cve_id=req.body.cve_id;
    cve_list.updateOne({"cveid":cve_id}, {$set:{"module_or_feature_impacted":module_or_feature_impacted}},function(err, response){
        if(err){
            res.status(500).json({ success: false ,error:JSON.stringify(err)}).end('');
        }
        else{
            res.status(200).json({ success: true,module_or_feature_impacted:module_or_feature_impacted}).end('');
        }
    }
    );
}



exports.targetOsVersion = function(req, res, next) {
    var target_os_version=req.body.target_os_version;
    var cve_id=req.body.cve_id;
    cve_list.updateOne({"cveid":cve_id}, {$set:{"target_os_version":target_os_version}},function(err, response){
        if(err){
            res.status(500).json({ success: false ,error:JSON.stringify(err)}).end('');
        }
        else{
            res.status(200).json({ success: true,target_os_version:target_os_version}).end('');
        }
    }
    );
}